# earlyLightCurvesReproduce

Can use the contents of this repository to reproduct the results of the simultions reported in our paper. Instructions on how to do so are below.

To reproduce the simulation of the collision dynamics run athena using the collision sim athinput and pgen file with the radIdeal eos set in spherical polar coordinates and on the fork located at https://zenodo.org/records/14768226. 

Once that is done the data can be processed, first by running the processFiles function located inside the processFiles file with the correct paths to the athena output directories and whatnot. Following this you can use newFileAnalysis and run the evolveEdgeFull function and makeHDF5data function with the nickel mass you want to perform the evolution described in section 3 of the paper.

Once that is done you can run processHDF5 on the output of the makeHDF5data, with that data you can then run lowerFloor in processFiles and then processExtraDataOctree, with the outputs of both lowerFloor functions in one file you have data that is ready for the next stage. For the next stage just work an a regular fork of athena with nr radiation, replace the athena_hdf5.cpp file with the one provided and edit the outputs to output intensity data when and where you want. Following this compile the pgen located in fourPercentFirstSixHours with nr_radiation enabled and then run the athena file from that with the athinput provided in a folder with all the output files obtained from the lowerFloor functions. Make sure the athinput has the nickel mass you want, should also provide the number of data points for the code to read in for the regular code and the edge (number of lines in txt file) via NumToRead and NumToReadEdge inputs of the athinput file.

With the output of the first sim you can restart it on a new grid (if your computer necessitates doing this) using the athinput and athena in fourPercentSixHoursToEnd. You can then run processFilesAthdf on a folder with just the last athdf of the originall sim in processFiles and take the output of that and put it into a file with intensitiesRestart.txt and locationsRestart.txt as well as the final .athdf file and run processFinalFiles with the readIntensitiesLocations updated with the correct meshblock sizes and grid sizes that you used. With all of that done take all the binary files produced and run the athena with the athinput in fourPercentSixHoursToEnd and athena_hdf5 updated to record intensities as you want, the data of the interpolated radial grid shoudl be provided as the inner radius provided as "innerBound", the outer bound provided as "outerBound" and the resolution provided as "radiusResolution" in the athinput file. Max radius force can also be used to force material outside of a desired radius to be floor, ensure that this is sight a few cells inside of the boundary of the original simulation (but outside the final measurement radius), this avoids a numerical error. With all of that done the code will run properly.
